<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace 必须对应 Mapper 接口的全类名 -->
<mapper namespace="com.interview.mapper.QuestionMapper">

    <!-- 实现 updateBatchById 方法，批量更新 Question 实体 -->
    <update id="updateBatchById" parameterType="java.util.List">
        UPDATE question
        SET status = CASE
            <!-- 遍历列表，为每个主键 ID 匹配对应的 status 值 -->
            <foreach collection="list" item="item" separator="">
                WHEN id = #{item.id} THEN #{item.status}
            </foreach>
        END,
        update_time = CASE
            <!-- 遍历列表，为每个主键 ID 匹配对应的 updateTime 值 -->
            <foreach collection="list" item="item" separator="">
                WHEN id = #{item.id} THEN #{item.updateTime}
            </foreach>
        END
        <!-- 关键：限定更新范围，避免全表更新 -->
        WHERE id IN
        <foreach collection="list" item="item" open="(" separator="," close=")">
            #{item.id}
        </foreach>
    </update>

</mapper>